<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D3.js Workshop - NASA Asteroid Visualizations</title>
    <link rel="stylesheet" href="css/styles.css">
    <!-- D3.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
</head>
<body>
    <header>
        <h1>üöÄ D3.js Workshop: NASA Asteroid Visualizations</h1>
        <p>Exploring Near-Earth Objects (NEO) data from January 1-8, 2024</p>
        <div id="data-summary"></div>
        <div id="loading" class="loading">Loading asteroid data...</div>
    </header>

    <main id="dashboard">
        <!-- Categorical/Comparison Charts -->
        <section class="chart-section">
            <h2>üìä Categorical & Comparison Charts</h2>
            
            <div class="chart-card">
                <h3>Bar Chart</h3>
                <p class="chart-description">Top 10 asteroids by estimated diameter</p>
                <div id="bar-chart" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Horizontal Bar Chart</h3>
                <p class="chart-description">Asteroids sorted by relative velocity</p>
                <div id="horizontal-bar" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Grouped Bar Chart</h3>
                <p class="chart-description">Hazardous vs non-hazardous by size category</p>
                <div id="grouped-bar" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Stacked Bar Chart</h3>
                <p class="chart-description">Daily count of hazardous and non-hazardous asteroids</p>
                <div id="stacked-bar" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Pie Chart</h3>
                <p class="chart-description">Percentage of hazardous vs non-hazardous asteroids</p>
                <div id="pie-chart" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Donut Chart</h3>
                <p class="chart-description">Hazardous asteroid distribution with center label</p>
                <div id="donut-chart" class="chart-container"></div>
            </div>
        </section>

        <!-- Distribution Charts -->
        <section class="chart-section">
            <h2>üìà Distribution Charts</h2>
            
            <div class="chart-card">
                <h3>Histogram</h3>
                <p class="chart-description">Distribution of asteroid velocities</p>
                <div id="histogram" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Box Plot</h3>
                <p class="chart-description">Asteroid size distribution with quartiles</p>
                <div id="box-plot" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Violin Plot</h3>
                <p class="chart-description">Velocity distribution density visualization</p>
                <div id="violin-plot" class="chart-container"></div>
            </div>
        </section>

        <!-- Relationship/Correlation Charts -->
        <section class="chart-section">
            <h2>üîó Relationship & Correlation Charts</h2>
            
            <div class="chart-card">
                <h3>Scatter Plot</h3>
                <p class="chart-description">Asteroid size vs velocity relationship</p>
                <div id="scatter-plot" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Bubble Chart</h3>
                <p class="chart-description">Size, velocity, and miss distance (3 variables)</p>
                <div id="bubble-chart" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Heatmap</h3>
                <p class="chart-description">Asteroid density by size and velocity ranges</p>
                <div id="heatmap" class="chart-container"></div>
            </div>
        </section>

        <!-- Time-Based Charts -->
        <section class="chart-section">
            <h2>‚è∞ Time-Based Charts</h2>
            
            <div class="chart-card">
                <h3>Line Chart</h3>
                <p class="chart-description">Daily asteroid count over time</p>
                <div id="line-chart" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Area Chart</h3>
                <p class="chart-description">Cumulative asteroids over the date range</p>
                <div id="area-chart" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Stream Graph</h3>
                <p class="chart-description">Hazardous and non-hazardous flow over time</p>
                <div id="stream-graph" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Timeline</h3>
                <p class="chart-description">Individual asteroid closest approach dates</p>
                <div id="timeline" class="chart-container"></div>
            </div>
        </section>

        <!-- Part-to-Whole Charts -->
        <section class="chart-section">
            <h2>üß© Part-to-Whole Charts</h2>
            
            <div class="chart-card">
                <h3>Treemap</h3>
                <p class="chart-description">Hierarchical view by date and size category</p>
                <div id="treemap" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Sunburst Chart</h3>
                <p class="chart-description">Radial hierarchical visualization</p>
                <div id="sunburst" class="chart-container"></div>
            </div>
        </section>

        <!-- Network/Relationship Charts -->
        <section class="chart-section">
            <h2>üï∏Ô∏è Network & Flow Charts</h2>
            
            <div class="chart-card">
                <h3>Force-Directed Graph</h3>
                <p class="chart-description">Cluster asteroids by similar properties</p>
                <div id="force-directed" class="chart-container"></div>
            </div>

            <div class="chart-card">
                <h3>Sankey Diagram</h3>
                <p class="chart-description">Flow from dates to size categories to hazard status</p>
                <div id="sankey" class="chart-container"></div>
            </div>
        </section>
    </main>

    <footer>
        <p>Data source: <a href="https://api.nasa.gov/" target="_blank">NASA NeoWs API</a></p>
        <p>Built with <a href="https://d3js.org/" target="_blank">D3.js v7.8.5</a></p>
    </footer>

    <!-- Configuration (API Key) -->
    <script src="config.js"></script>
    
    <!-- Data Fetcher -->
    <script src="js/data_fetcher.js"></script>

    <!-- Visualization Scripts -->
    <script src="js/bar_chart.js"></script>
    <script src="js/horizontal_bar.js"></script>
    <script src="js/grouped_bar.js"></script>
    <script src="js/stacked_bar.js"></script>
    <script src="js/pie_chart.js"></script>
    <script src="js/donut_chart.js"></script>
    <script src="js/histogram.js"></script>
    <script src="js/box_plot.js"></script>
    <script src="js/violin_plot.js"></script>
    <script src="js/scatter_plot.js"></script>
    <script src="js/bubble_chart.js"></script>
    <script src="js/heatmap.js"></script>
    <script src="js/line_chart.js"></script>
    <script src="js/area_chart.js"></script>
    <script src="js/stream_graph.js"></script>
    <script src="js/timeline.js"></script>
    <script src="js/treemap.js"></script>
    <script src="js/sunburst.js"></script>
    <script src="js/force_directed.js"></script>
    <script src="js/sankey.js"></script>

    <!-- Main initialization script -->
    <script>
        // Initialize the dashboard when page loads
        async function initDashboard() {
            try {
                // Fetch and process data
                const data = await initializeData();
                
                // Hide loading indicator
                document.getElementById('loading').style.display = 'none';
                
                // Show data summary
                const summary = document.getElementById('data-summary');
                summary.innerHTML = `
                    <div class="summary-stats">
                        <span class="stat">Total Asteroids: <strong>${data.total_count}</strong></span>
                        <span class="stat hazardous">Hazardous: <strong>${data.hazardous_count}</strong></span>
                        <span class="stat safe">Non-Hazardous: <strong>${data.non_hazardous_count}</strong></span>
                    </div>
                `;
                
                // Render all visualizations
                // Categorical/Comparison
                if (typeof renderBarChart === 'function') renderBarChart('bar-chart', data);
                if (typeof renderHorizontalBar === 'function') renderHorizontalBar('horizontal-bar', data);
                if (typeof renderGroupedBar === 'function') renderGroupedBar('grouped-bar', data);
                if (typeof renderStackedBar === 'function') renderStackedBar('stacked-bar', data);
                if (typeof renderPieChart === 'function') renderPieChart('pie-chart', data);
                if (typeof renderDonutChart === 'function') renderDonutChart('donut-chart', data);
                
                // Distribution
                if (typeof renderHistogram === 'function') renderHistogram('histogram', data);
                if (typeof renderBoxPlot === 'function') renderBoxPlot('box-plot', data);
                if (typeof renderViolinPlot === 'function') renderViolinPlot('violin-plot', data);
                
                // Relationship
                if (typeof renderScatterPlot === 'function') renderScatterPlot('scatter-plot', data);
                if (typeof renderBubbleChart === 'function') renderBubbleChart('bubble-chart', data);
                if (typeof renderHeatmap === 'function') renderHeatmap('heatmap', data);
                
                // Time-based
                if (typeof renderLineChart === 'function') renderLineChart('line-chart', data);
                if (typeof renderAreaChart === 'function') renderAreaChart('area-chart', data);
                if (typeof renderStreamGraph === 'function') renderStreamGraph('stream-graph', data);
                if (typeof renderTimeline === 'function') renderTimeline('timeline', data);
                
                // Part-to-whole
                if (typeof renderTreemap === 'function') renderTreemap('treemap', data);
                if (typeof renderSunburst === 'function') renderSunburst('sunburst', data);
                
                // Network
                if (typeof renderForceDirected === 'function') renderForceDirected('force-directed', data);
                if (typeof renderSankey === 'function') renderSankey('sankey', data);
                
                console.log('‚úÖ All visualizations rendered!');
            } catch (error) {
                console.error('‚ùå Error initializing dashboard:', error);
                document.getElementById('loading').innerHTML = '‚ùå Error loading data. Please refresh the page.';
            }
        }

        // Start the dashboard when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initDashboard);
        } else {
            initDashboard();
        }
    </script>
</body>
</html>
